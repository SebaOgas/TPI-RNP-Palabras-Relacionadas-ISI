href="https://colab.research.google.com
github
institutohumai
cursos-python
blob
master
CV/4TransferLearning/3_TransferenciaEstilos.ipynb
img
src='https://colab.research.google.com
assets
colab-badge.svg
/a
Transferencia
Estilos
entusiasta
fotografía
esté
familiarizado
filtros
filtros
cambiar
estilo
color
fotos
fotos
paisajes
vuelvan
nítidas
fotos
retratos
tengan
pieles
blancas
filtro
generalmente
cambia
aspecto
foto
aplicar
estilo
ideal
foto
probablemente
necesite
probar
combinaciones
filtros
proceso
complejo
ajustar
hiperparámetros
modelo
clase
aprovecharemos
representaciones
capas
CNN
aplicar
automáticamente
estilo
imagen
imagen
haremos
transferencias
estilos
tarea
necesita
imágenes
entrada
imagen
contenido
imagen
estilo
Usaremos
redes
neuronales
modificar
imagen
contenido
estilo
acerque
imagen
estilo
ejemplo
imagen
contenido
figura
foto
paisaje
imagen
estilo
pintura
óleo
robles
otoñales
imagen
sintetizada
salida
aplican
trazos
pincel
óleo
imagen
estilo
lugar
colores
vivos
tiempo
conserva
forma
principal
objetos
imagen
contenido
Método
figura
ilustra
método
transferencia
estilo
basado
CNN
ejemplo
simplificado
inicializamos
imagen
sintetizada
ejemplo
imagen
contenido
imagen
sintetizada
única
variable
actualizarse
proceso
transferencia
estilo
parámetros
modelo
actualizarán
entrenamiento
elegimos
CNN
preentrenada
extraer
características
imagen
congelamos
parámetros
modelo
entrenamiento
CNN
profunda
utiliza
capas
extraer
características
jerárquicas
imágenes
elegir
salida
capas
características
contenido
características
estilo
ejemplo
figura
red
neuronal
preentrenada
capas
convolucionales
capa
genera
características
contenido
capas
generan
características
estilo
continuación
calculamos
función
pérdida
transferencia
estilo
propagación
dirección
flechas
continuas
actualizamos
parámetros
modelo
imagen
sintetizada
salida
propagación
atrás
dirección
flechas
discontinuas
función
pérdida
comúnmente
utilizada
transferencia
estilo
consta
partes
pérdida
contenido
imagen
sintetizada
imagen
contenido
acerquen
características
contenido
pérdida
estilo
imagen
sintetizada
imagen
estilo
acerquen
características
estilo
pérdida
variación
ayuda
reducir
ruido
imagen
sintetizada
Finalmente
finaliza
entrenamiento
modelo
generamos
parámetros
modelo
transferencia
estilo
generar
imagen
sintetizada
continuación
explicaremos
detalles
técnicos
transferencia
estilo
experimento
concreto
Implementación
Leer
imágenes
estilo
contenido
leemos
contenido
estilo
imágenes
ejes
coordenadas
impresos
imágenes
tamaños
Preprocesamiento
posprocesamiento
continuación
definimos
funciones
preprocesamiento
posprocesamiento
imágenes
función
preprocess
estandariza
canales
RGB
imagen
entrada
transforma
resultados
formato
entrada
CNN
función
postprocess
restaura
valores
píxeles
imagen
salida
valores
originales
estandarización
función
impresión
imágenes
requiere
píxel
valor
punto
flotante
reemplazamos
valor
menor
respectivamente
Extracción
características
modelo
VGG-19
preentrenado
conjunto
datos
ImageNet
extraer
características
imagen
extraer
características
contenido
características
estilo
imagen
seleccionar
salida
capas
red
VGG
términos
generales
cerca
capa
entrada
fácil
extraer
detalles
imagen
lejos
fácil
extraer
información
global
imagen
evitar
retener
excesivamente
detalles
imagen
contenido
imagen
sintetizada
elegimos
capa
VGG
cerca
salida
capa
contenido
generar
características
contenido
imagen
seleccionamos
salida
capas
VGG
extraer
características
estilo
locales
globales
capas
denominan
capas
estilo
red
VGG
bloques
convolucionales
experimento
elegimos
capa
convolucional
cuarto
bloque
convolucional
capa
contenido
capa
convolucional
bloque
convolucional
capa
estilo
índices
capas
obtener
imprimiendo
instancia
pretrained_net
extraer
características
usando
capas
VGG
necesitamos
capa
entrada
capa
contenido
capa
estilo
cercana
capa
salida
Construyamos
red
net
conserve
capas
VGG
utilizarán
extracción
características
Dada
entrada
simplemente
invocamos
función
forward
net(X
obtener
salida
capa
necesitamos
salidas
capas
intermedias
debemos
cálculos
capa
capa
mantener
salidas
capas
contenido
estilo
continuación
definen
funciones
función
getcontents
extrae
características
contenido
imagen
contenido
función
getstyles
extrae
características
estilo
imagen
estilo
necesario
actualizar
parámetros
modelo
VGG
preentrenado
entrenamiento
extraer
contenido
características
estilo
comience
entrenamiento
imagen
sintetizada
conjunto
parámetros
modelo
actualizará
transferencia
estilo
extraer
contenido
características
estilo
imagen
sintetizada
llamando
función
extract_features
entrenamiento
Definición
función
pérdida
describiremos
función
pérdida
transferencia
estilo
función
pérdida
consiste
pérdida
contenido
pérdida
estilo
pérdida
variación
Pérdida
contenido
Similar
función
pérdida
regresión
lineal
pérdida
contenido
mide
diferencia
características
contenido
imagen
sintetizada
imagen
contenido
error
cuadrático
Pérdida
estilo
pérdida
estilo
similar
pérdida
contenido
utiliza
error
cuadrático
medir
diferencia
estilo
imagen
sintetizada
imagen
estilo
expresar
salida
estilo
capa
estilo
función
extractfeatures
calcular
salida
capa
estilo
Suponiendo
salida
ejemplo
canales
altura
ancho
transformar
salida
matriz
filas
columnas
matriz
considerar
concatenación
vectores
longitud
vector
representa
función
estilo
canal
crearemos
matriz
Gram
vectores
matriz
elemento
fila
columna
producto
escalar
vectores
representa
correlación
características
estilo
canales
matriz
Gram
representar
salida
estilo
capa
estilo
valor
probable
genere
valores
mayores
matriz
Gram
alto
ancho
matriz
Gram
número
canales
permitir
pérdida
estilo
vea
afectada
valores
función
gram
divide
matriz
Gram
número
elementos
Obviamente
matrices
Gram
entradas
pérdida
estilo
basan
salidas
capa
estilo
imagen
sintetizada
imagen
estilo
supone
matriz
Gram
gram_Y
basada
imagen
estilo
precalculada
Pérdida
variación
imagen
sintetizada
aprendida
ruido
alta
frecuencia
píxeles
particularmente
brillantes
oscuros
método
común
reducción
ruido
eliminación
ruido
variación
Denote
valor
píxel
coordenada
Reducir
pérdida
variación
definida
acerca
valores
píxeles
vecinos
imagen
sintetizada
Función
pérdida
función
pérdida
transferencia
estilo
suma
ponderada
pérdida
contenido
pérdida
estilo
pérdida
variación
ajustar
hiperparámetros
peso
equilibrar
retención
contenido
transferencia
estilo
reducción
ruido
imagen
sintetizada
Inicializar
imagen
sintetizada
transferencia
estilo
imagen
sintetizada
única
variable
actualizarse
entrenamiento
definir
modelo
simple
SynthesizedImage
tratar
imagen
sintetizada
parámetros
modelo
modelo
propagación
directa
devuelve
parámetros
modelo
continuación
definimos
función
getinits
función
crea
instancia
modelo
SynthesizedImage
inicializa
imagen
X.
matrices
Gram
imagen
estilo
capas
estilo
stylesY_gram
calculan
entrenamiento
Entrenamiento
entrenar
modelo
transferencia
estilo
extraemos
continuamente
características
contenido
características
estilo
imagen
sintetizada
calculamos
función
pérdida
continuación
define
ciclo
entrenamiento
comenzamos
entrenar
modelo
Redimensionamos
altura
ancho
imágenes
estilo
contenido
300
450
píxeles
imagen
contenido
inicializar
imagen
sintetizada
imagen
sintetizada
retiene
escenario
objetos
imagen
contenido
transfiere
color
imagen
estilo
tiempo
ejemplo
imagen
sintetizada
bloques
color
imagen
estilo
bloques
sutil
textura
pinceladas
